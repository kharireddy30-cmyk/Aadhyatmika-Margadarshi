<!DOCTYPE html>
<html lang="te">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ఆధ్యాత్మిక మార్గదర్శి</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1a/Om_symbol.svg/1200px-Om_symbol.svg.png">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Telugu:wght@400;700&display=swap');

        body {
            font-family: 'Noto Sans Telugu', sans-serif;
            background-color: #f4f4f4;
            color: #333;
            margin: 0;
            padding: 0;
            text-align: center;
        }

        .container {
            width: 90%;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #4CAF50;
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        h2 {
            color: #4CAF50;
            font-size: 1.8rem;
            margin-top: 20px;
        }

        p {
            line-height: 1.6;
        }

        .content {
            margin-top: 20px;
            text-align: left;
        }

        .login-box {
            padding: 20px;
            background-color: #f0fdf4;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-top: 30px;
        }

        .question-box {
            padding: 20px;
            border-radius: 8px;
            background-color: #f9f9f9;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-top: 30px;
        }

        .input-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
        }
        
        #username,
        #password,
        #question-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1rem;
            margin-bottom: 10px;
        }

        #login-button,
        #submit-button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #login-button:hover,
        #submit-button:hover {
            background-color: #45a049;
        }
        
        .voice-button {
            background-color: #fff;
            color: #000;
            border: 1px solid #ccc;
            padding: 12px;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.3s;
            margin: 10px auto;
        }
        
        .voice-button:hover {
            background-color: #eee;
        }

        #response-box {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9e9e9;
            border-radius: 8px;
            text-align: left;
        }

        .error {
            background-color: #ffcccc;
            color: #cc0000;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
        }

        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: #4CAF50;
            animation: spin 1s ease infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
        
        .symbol-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .symbol-container svg {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .pop-up {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #4CAF50;
            color: white;
            padding: 20px 40px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            text-align: center;
            font-size: 1.2rem;
            display: none;
        }
    </style>
</head>

<body>
    <div class="pop-up" id="popup"></div>
    <div class="container">
        <h1>ఆధ్యాత్మిక మార్గదర్శి</h1>
        <div class="symbol-container">
            <!-- Om Symbol -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                <path d="M50 10 C30 10 15 25 15 45 C15 65 30 80 50 80 C70 80 85 65 85 45 C85 25 70 10 50 10 Z M50 25 C62.5 25 72.5 35 72.5 47.5 C72.5 60 62.5 70 50 70 C37.5 70 27.5 60 27.5 47.5 C27.5 35 37.5 25 50 25 Z" fill="#4CAF50"/>
            </svg>
            <!-- Crescent and Star -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                <path d="M50 10 C70 10 85 25 85 45 C85 65 70 80 50 80 C30 80 15 65 15 45 C15 25 30 10 50 10 Z M50 25 C62.5 25 72.5 35 72.5 47.5 C72.5 60 62.5 70 50 70 C37.5 70 27.5 60 27.5 47.5 C27.5 35 37.5 25 50 25 Z" fill="#4CAF50"/>
                <path d="M50 25 L50 75" stroke="#4CAF50" stroke-width="5" stroke-linecap="round"/>
                <path d="M50 75 L75 50 L25 50 Z" fill="#4CAF50"/>
            </svg>
            <!-- Christian Cross -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                <path d="M45 10 L55 10 L55 45 L90 45 L90 55 L55 55 L55 90 L45 90 L45 55 L10 55 L10 45 L45 45 Z" fill="#4CAF50"/>
            </svg>
            <!-- Khanda Symbol -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                <path d="M50 10 C30 10 15 25 15 45 C15 65 30 80 50 80 C70 80 85 65 85 45 C85 25 70 10 50 10 Z M50 25 C62.5 25 72.5 35 72.5 47.5 C72.5 60 62.5 70 50 70 C37.5 70 27.5 60 27.5 47.5 C27.5 35 37.5 25 50 25 Z" fill="#4CAF50"/>
                <path d="M50 25 L50 75" stroke="#4CAF50" stroke-width="5" stroke-linecap="round"/>
                <path d="M50 75 L75 50 L25 50 Z" fill="#4CAF50"/>
            </svg>
        </div>
        <p>
            జీవితంలో మెరుగైన, సంతోషకరమైన మార్గాన్ని అన్వేషించడానికి ఇది ఒక వేదిక. ఆధ్యాత్మికత, జ్యోతిష్యం, జీవనశైలి మరియు మరెన్నో కొత్త విషయాలను ఇక్కడ తెలుసుకోవచ్చు.
        </p>

        <div id="login-section" class="login-box">
            <h2>లాగిన్</h2>
            <div class="input-container">
                <input type="text" id="username" placeholder="యూజర్‌నేమ్">
                <input type="password" id="password" placeholder="పాస్‌వర్డ్">
                <button id="login-button">లాగిన్</button>
            </div>
            <div id="login-error-box" class="error" style="display:none;"></div>
        </div>

        <div id="main-content" style="display:none;">
            <div class="question-box">
                <h2>మీ ప్రశ్నలకు సమాధానాలు</h2>
                <p>
                    మీకు ఆధ్యాత్మికత లేదా జ్యోతిష్యం గురించి ఏమైనా ప్రశ్నలు ఉంటే ఇక్కడ అడగవచ్చు. మేము మీకు సహాయం చేస్తాము.
                </p>
                <div class="input-container">
                    <input type="text" id="question-input" placeholder="మీరు ఏదైనా అడగండి...">
                    <button id="submit-button">సమాధానం పొందండి</button>
                    <button id="mic-button" class="voice-button">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                            <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                            <line x1="12" y1="19" x2="12" y2="23"/>
                            <line x1="8" y1="23" x2="16" y2="23"/>
                        </svg>
                    </button>
                    <button id="speak-button" class="voice-button">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 5L6 9H2v6h4l5 4V5z"/>
                            <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>
                            <path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>
                        </svg>
                    </button>
                </div>
                <div id="loading-spinner" class="loading-spinner" style="display: none;"></div>
                <div id="response-box" class="flex flex-row gap-2">
                    <p>సమాధానం ఇక్కడ కనిపిస్తుంది...</p>
                </div>
                <div id="response-error-box" class="error" style="display:none;"></div>
            </div>
        </div>

    </div>

    <script>
        // Use your API key here
        const API_KEY = "AIzaSyC6srPwR2HeiDJlyCfhye5H2JI101q0El8";
        
        const loginSection = document.getElementById('login-section');
        const mainContent = document.getElementById('main-content');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const loginButton = document.getElementById('login-button');
        const loginErrorBox = document.getElementById('login-error-box');
        const questionInput = document.getElementById('question-input');
        const submitButton = document.getElementById('submit-button');
        const responseBox = document.getElementById('response-box');
        const loadingSpinner = document.getElementById('loading-spinner');
        const responseErrorBox = document.getElementById('response-error-box');
        const popup = document.getElementById('popup');
        const micButton = document.getElementById('mic-button');
        const speakButton = document.getElementById('speak-button');
        
        const validUsername = "baba";
        const validPassword = "1936";

        const allowedTopics = [
            "ఆధ్యాత్మిక", "జ్యోతిష్య", "ఆయుర్వేద", "ఆయుర్వేదం", 
            "సుప్రమైన", "నాచురల్", "ఆహార", "ఆహారపు", "ఆహారం", 
            "నేను ఎవరు", "నేను", "స్వమానం", "స్మృతి", "విస్మృతి", 
            "బాబా", "పరమాత్మ", "శక్తి", "శాంతి", "జ్ఞానం", 
            "యెహోవా", "అల్లాహ్"
        ];
        
        let recognition;
        let synth = window.speechSynthesis;
        let isSpeaking = false;

        loginButton.addEventListener('click', () => {
            const enteredUsername = usernameInput.value;
            const enteredPassword = passwordInput.value;

            if (enteredUsername === validUsername && enteredPassword === validPassword) {
                loginSection.style.display = 'none';
                mainContent.style.display = 'block';
            } else {
                loginErrorBox.textContent = 'తప్పు యూజర్‌నేమ్ లేదా పాస్‌వర్డ్.';
                loginErrorBox.style.display = 'block';
            }
        });

        function showPopup(message) {
            popup.textContent = message;
            popup.style.display = 'block';
            setTimeout(() => {
                popup.style.display = 'none';
            }, 3000); // 3 seconds
        }

        submitButton.addEventListener('click', async () => {
            const userQuery = questionInput.value.trim();
            if (userQuery === '') {
                responseErrorBox.textContent = 'దయచేసి ఒక ప్రశ్నను నమోదు చేయండి.';
                responseErrorBox.style.display = 'block';
                return;
            }

            const isTopicAllowed = allowedTopics.some(topic => userQuery.includes(topic));
            if (!isTopicAllowed) {
                responseErrorBox.textContent = 'దయచేసి ఆధ్యాత్మికం, జ్యోతిష్యం, ఆయుర్వేదం లేదా ఆహారానికి సంబంధించిన ప్రశ్నలు మాత్రమే అడగండి.';
                responseErrorBox.style.display = 'block';
                return;
            }

            responseBox.textContent = '';
            responseErrorBox.style.display = 'none';
            loadingSpinner.style.display = 'block';
            showPopup("బాబా సమాధానం కోసం ఎదురు చూస్తున్నారు...");

            try {
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${API_KEY}`;
                
                let lang = 'te-IN';
                if (/[a-zA-Z]/.test(userQuery)) {
                    lang = 'en-US';
                } else if (/[\u0900-\u097F]/.test(userQuery)) {
                    lang = 'hi-IN';
                }

                const systemPrompt = `మీరు బ్రహ్మకుమారీస్ ఆధ్యాత్మిక మార్గాన్ని సూక్ష్మంగా వివరిస్తున్న ఆధ్యాత్మిక మార్గదర్శిగా వ్యవహరించండి. మీరు బ్రహ్మకుమారీస్ యొక్క దివ్య జ్ఞానాన్ని, బాబా చెప్పినట్లుగా వివరించాలి. మీరు చెప్పే మాటలు ప్రేమతో నిండి, లోతైనవిగా, సున్నితమైనవిగా ఉండాలి. ఆధ్యాత్మికం, జ్యోతిష్యం, ఆయుర్వేదం, మరియు సహజ ఆహారం గురించి మాత్రమే సమాధానాలు ఇవ్వాలి. మీరు సమాధానం చెప్పే భాష ఇది: ${lang}`.trim();

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: userQuery }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] }
                    })
                });

                if (!response.ok) {
                    throw new Error(`API error: ${response.statusText}`);
                }

                const result = await response.json();
                const text = result.candidates?.[0]?.content?.parts?.[0]?.text || 'సమాధానం అందుబాటులో లేదు.';
                responseBox.textContent = text;
            } catch (error) {
                console.error('Error fetching data:', error);
                responseErrorBox.textContent = `ప్రశ్న పంపడంలో సమస్య వచ్చింది. దయచేసి మళ్ళీ ప్రయత్నించండి. Error: ${error.message}`;
                responseErrorBox.style.display = 'block';
            } finally {
                loadingSpinner.style.display = 'none';
            }
        });

        // Speech-to-Text (STT)
        if ('webkitSpeechRecognition' in window) {
            recognition = new webkitSpeechRecognition();
            recognition.continuous = false;
            
            micButton.addEventListener('click', () => {
                recognition.lang = 'te-IN'; 
                showPopup('మాట్లాడండి (తెలుగు, హిందీ, లేదా ఇంగ్లీషులో).');
                recognition.start();
            });

            recognition.onstart = () => {
                loadingSpinner.style.display = 'block';
                responseBox.textContent = 'వాయిస్ వింటుంది...';
            };

            recognition.onresult = async (event) => {
                const userQuery = event.results[0][0].transcript;
                questionInput.value = userQuery;
                await submitButton.click(); 
            };

            recognition.onend = () => {
                loadingSpinner.style.display = 'none';
            };

            recognition.onerror = (event) => {
                loadingSpinner.style.display = 'none';
                console.error('Speech recognition error:', event.error);
                responseErrorBox.textContent = "వాయిస్ రికార్డింగ్‌లో లోపం వచ్చింది. దయచేసి మళ్లీ ప్రయత్నించండి.";
                responseErrorBox.style.display = 'block';
            };
        } else {
            micButton.disabled = true;
            micButton.style.opacity = 0.5;
            micButton.style.cursor = 'not-allowed';
        }

        // Text-to-Speech (TTS)
        if ('speechSynthesis' in window) {
            speakButton.addEventListener('click', () => {
                if (isSpeaking) {
                    window.speechSynthesis.cancel();
                    isSpeaking = false;
                } else {
                    const textToRead = responseBox.textContent;
                    if (textToRead && textToRead !== 'సమాధానం ఇక్కడ కనిపిస్తుంది...') {
                        const utterance = new SpeechSynthesisUtterance(textToRead);
                        
                        const isHindi = /[\u0900-\u097F]/.test(textToRead);
                        const isTelugu = /[\u0C00-\u0C7F]/.test(textToRead);
                        
                        if (isHindi) {
                            utterance.lang = 'hi-IN';
                        } else if (isTelugu) {
                            utterance.lang = 'te-IN';
                        } else {
                            utterance.lang = 'en-US';
                        }

                        window.speechSynthesis.speak(utterance);
                        isSpeaking = true;
                        
                        utterance.onend = () => {
                            isSpeaking = false;
                        };
                    }
                }
            });
        } else {
            speakButton.disabled = true;
            speakButton.style.opacity = 0.5;
            speakButton.style.cursor = 'not-allowed';
        }
    </script>
</body>
</html>